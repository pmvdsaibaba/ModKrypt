Given $\Pi_{MAC}$ = (Gen, Enc, Ver)\\

% \begin{center}
%     $ t \leftarrow c = Enc(k,m) $ 
% \end{center}

To prove by reduction as in Figure \ref{Reduction}

\begin{figure}[h]
    \includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{8-1.jpg}
    \caption{Proof by Reduction}
    \label[figure]{Reduction}
    \centering
\end{figure}

Lets assume contradiction i.e., the MAC construction is not secure $\Rightarrow$ Probablity of forging
this construction $\Pi_{MAC}$ is a non negligible function. i.e.,

\begin{center}
    $Pr[MacForge_{A,\Pi_{MAC}} = 1] \leq \epsilon(\lambda)$
\end{center}
where $\epsilon(\lambda)$ is a non negligible function.\\


That implies there exists an adversary, A, able to generate a new message and tag pair $(m^*, t^*)$
such that $m^* \notin Q $, and $Ver_k(m^*, t^*) == 1$ with a probablity $\epsilon(\lambda)$. 
% As per the reduction, Ver uses the Dec by comparing $m^*$ with the message from Dec as shown in the Figure \ref*{Reduction}. 
\newline

% Let ValidQuery be the event that B submits a new $(c', t')$ to its
% decryption oracle, Dec' without querying to Enc


% A MAC fogery is only possible when the $m*$ is not queried before and $t*$ should
% be a valid. There exists a distinguisher 

% That means there exits an Adversary, A' able to use the decryption oracel Dec'
% with a new valid tag, $t^*$ and get the message $m''$ and distuingush with  $m^*$ with a probablity $ 1/2 + \epsilon(\lambda)$


% \begin{align}
%     % Pr[ PrivK_{A,\Pi}(\lambda) = 1  \wedge \overline{ValidQuery}]  \leq \epsilon(\lambda)
%      Pr[ PrivK_{A',\Pi}(\lambda) = 1 ] = 1/2 + \epsilon(\lambda)
%     \label{eq1}
% \end{align}

% That implies
% \begin{align}
%     % Pr[ PrivK_{A,\Pi}(\lambda) = 1  \wedge \overline{ValidQuery}]  \leq \epsilon(\lambda)
%     Pr[ PrivK_{A,\Pi}(\lambda) = 1 ]  \leq \epsilon(\lambda)
%     \label{eq1}
% \end{align}
% where $\epsilon(\lambda)$ is a non negligible function.\\



% But given that $\Pi$ is a CCA secure enryption scheme. So
% \begin{align}
%     % Pr[ PrivK_{A,\Pi}^{CCA}(\lambda) = 1  \wedge \overline{ValidQuery}]  \leq 1/2 + neg(\lambda)
%     Pr[ PrivK_{A',\Pi}^{CCA}(\lambda) = 1]  \leq 1/2 + neg(\lambda)
%     \label{eq2}
% \end{align}
% where $neg(\lambda)$ is a negligible function. 


% Equation (\ref*{eq1}) and (\ref*{eq2}) are contradecting to each other as our assumtion 
% that $\epsilon(\lambda)$ is not a negligible is false.


We now consider B attacking the MAC i.e., B runs A as subroutine. B choose two messages, lets 
say $\widetilde{m_0}$ and $\widetilde{m_1}$ as $m^*$ and any other random message
respectively. If B gets the tag a $t^*$, it corresponds to $m^*$ otherwise it correponds 
to random message. So here the success probablity of B is,
\begin{align}
    Pr[ PrivK_{B,\Pi'}^{CCA}(\lambda) = 1] \leq |1 - \epsilon(\lambda)|
    \label{eq1}
\end{align}

But given that $\Pi$ is a CCA secure enryption scheme. So for CCA secure Adversary A',
\begin{align}
    Pr[ PrivK_{A',\Pi}^{CCA}(\lambda) = 1]  \leq 1/2 + neg(\lambda)
    \label{eq2}
\end{align}
where $neg(\lambda)$ is a negligible function. \\

Both equations (\ref*{eq1}) and (\ref*{eq2}) are valid only when
unless $\epsilon(\lambda)$ is a negligible function which is contradiction to 
our assumption. Hence our assumption that such an Adversary exists is false. 
And the construction is secure.
